<!DOCTYPE html>

<!--
  portfolYOU Jekyll theme by Youssef Raafat
  Free for personal and commercial use under the MIT license
  https://github.com/YoussefRaafatNasry/portfolYOU
-->

<html lang="en" class="h-100">

<head>

  
  

  

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:type" content="website">
  <meta property="og:title" content="TLT : Transformer-Lightning Language Model">
  <meta property="og:description" content="This is an implementation of a transformer based language model using Pytorch-Lightning framework. The model consists of two transformer layers with 2 heads ...">

  <title>TLT : Transformer-Lightning Language Model</title>
  <meta name="description" content="This is an implementation of a transformer based language model using Pytorch-Lightning framework. The model consists of two transformer layers with 2 heads ...">

  <link rel="shortcut icon" type="image/x-icon" href="/assets/favicon.ico">

  <!-- Theme style -->
  <script src="/assets/js/theme.js"></script>

  <!-- Font Awesome CDN -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.10.0/css/all.css">

  <!-- Bootstrap CSS CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">

  <!-- Animate CSS CDN -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.css">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/assets/css/style.css">

</head>

<body class="h-100 d-flex flex-column">

  <main class="flex-shrink-0 container mt-5">
    <nav class="navbar navbar-expand-lg navbar-themed">

  <a class="navbar-brand" href="/"><h5><b>Waleed Khamies's Website</b></h5></a>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
    <i class="fas fa-1x fa-bars text-themed"></i>
  </button>

  <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
    <div class="navbar-nav ml-auto">
<a class="nav-item nav-link active" href="/">Home</a>

      <a class="nav-item nav-link " href="/blog/">Blog</a>

      <a class="nav-item nav-link active" href="/projects/">Projects</a>

      <a class="nav-item nav-link " href="/about/">About</a>

      

      <span id="theme-toggler" class="nav-item nav-link" role="button" onclick="toggleTheme()"></span>
    </div>
  </div>

</nav>
    <div class="col-lg-10 mx-auto mt-5 markdown-body">
  <h1 id="tlt--transformer-lightning-language-model">TLT : Transformer-Lightning Language Model</h1>

<p><img src="../media/projects/transformer.jpg" align="center" height="750" width="800"></p>

<h3 id="table-of-contents">Table of Contents</h3>

<ul>
  <li><strong><a href="#Introduction">Introduction</a></strong></li>
  <li><strong><a href="#Setup">Setup</a></strong></li>
  <li><a href="#Run-the-code"><strong>Run the code</strong></a></li>
  <li><strong><a href="#Training">Training</a></strong></li>
  <li><strong><a href="#Sample-Generation">Sample Generation</a></strong></li>
  <li><strong><a href="#Connect-with-me">Connect with me</a></strong></li>
  <li><strong><a href="#License">License</a></strong></li>
</ul>

<h3 id="introduction">Introduction</h3>

<p>This is an implementation of a transformer based language model using <a href="https://www.pytorchlightning.ai/">Pytorch-Lightning framework</a>. The model consists of two transformer layers with 2 heads each combined with embedding and linear layers. The code uses pytorch-lightning framework that is built for fast research prototyping. Although the code does not leverage all the features of the lightning framework, but it has achieved good result in the language modelling task. For learning purposes, a Pytorch classical version from this project is also provided <a href="https://colab.research.google.com/drive/1zRm0tfD2gYyL2WNd6o_mVC2IY3prAzPV?usp=sharing">here</a> (inspired from Pytorch team  <img class="emoji" title=":heart:" alt=":heart:" src="https://github.githubassets.com/images/icons/emoji/unicode/2764.png" height="20" width="20">).</p>

<h3 id="setup">Setup</h3>

<p>The code is using <code class="language-plaintext highlighter-rouge">pipenv</code> as a virtual environment and package manager. To run the code, all you need is to install the necessary dependencies. open the terminal and type:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">$ git clone https://github.com/Khamies/Transformer_Lightning.git</code></li>
  <li><code class="language-plaintext highlighter-rouge">$ cd Transformer_Lightning</code></li>
  <li><code class="language-plaintext highlighter-rouge">$ pipenv install</code></li>
</ul>

<p>or</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">$ pip install requirements.txt </code></li>
</ul>

<p>And you should be ready to go to play with code and build upon it!</p>

<h3 id="run-the-code">Run the code</h3>

<ul>
  <li>
    <p>To train the model, run: <code class="language-plaintext highlighter-rouge">python main.py</code></p>
  </li>
  <li>
    <p>To train the model with specific arguments, run: <code class="language-plaintext highlighter-rouge">python main.py --batch_size=64</code>. The following command-line arguments are available:</p>
    <ul>
      <li>Train batch size: <code class="language-plaintext highlighter-rouge">--bsz_train</code>
</li>
      <li>Test batch size: <code class="language-plaintext highlighter-rouge">--bsz_test</code>
</li>
      <li>bptt: <code class="language-plaintext highlighter-rouge">--bptt</code>
</li>
      <li>Learning rate: <code class="language-plaintext highlighter-rouge">--lr</code>
</li>
      <li>Embedding size: <code class="language-plaintext highlighter-rouge">--embed_size</code>
</li>
      <li>Size of FeedForward Neural Network (1st layer): <code class="language-plaintext highlighter-rouge">--ffnn_size</code>
</li>
      <li>Attention Heads: <code class="language-plaintext highlighter-rouge">--nhead</code>
</li>
      <li>Transformer Layers: <code class="language-plaintext highlighter-rouge">--nlayers</code>
</li>
    </ul>
  </li>
</ul>

<h3 id="training">Training</h3>

<p>The model is trained on <code class="language-plaintext highlighter-rouge">10 epochs</code> using Adam as an optimizer with a <code class="language-plaintext highlighter-rouge">learning rate = 0.001</code> and <code class="language-plaintext highlighter-rouge">batch size = 32</code>, you can find all the model settings in <a href="https://github.com/Khamies/Transformer_Lightning/blob/main/settings.py">settings.py</a>. Here is the loss curve for the training step:</p>

<ul>
  <li>
    <p><strong>Cross Entropy Loss</strong></p>

    <p><img src="../media/projects/transformer_train_loss.jpg" align="center" height="300" width="500"></p>
  </li>
</ul>

<h3 id="sample-generation">Sample Generation</h3>

<p>Here are some generated samples from the model:</p>

<div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;time&gt;</span> warner owns n million francs.
<span class="nt">&lt;media&gt;</span> concern said it is a share n million.
</code></pre></div></div>

<h2 id="citation">Citation</h2>

<blockquote>
  <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>@misc{Khamies2021Transformer_Lightning,
author = {Khamies, Waleed},
title = {A pytorch implementation of transformer based language model using Pytorch-Lightning framework.},
year = {2021},
publisher = {GitHub},
journal = {GitHub repository},
howpublished = {\url{ https://github.com/Khamies/Transformer_Lightning}},
}
</code></pre></div>  </div>
</blockquote>

<h3 id="connect-with-me-slightly_smiling_face">Connect with me <img class="emoji" title=":slightly_smiling_face:" alt=":slightly_smiling_face:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f642.png" height="20" width="20">
</h3>

<p>For any question or a collaboration, drop me a message <a href="mailto:khamiesw@outlook.com?subject=%5BGitHub%5D%20LSTM-Language-Generator%20Repo">here</a></p>

<p>Follow me on <a href="https://www.linkedin.com/in/khamiesw/">Linkedin</a>!</p>

<p><strong>Thank you <img class="emoji" title=":heart:" alt=":heart:" src="https://github.githubassets.com/images/icons/emoji/unicode/2764.png" height="20" width="20"></strong></p>

<h3 id="license">License</h3>

<p><img src="https://img.shields.io/github/license/Khamies/Transformer_Lightning" alt=""></p>

</div>
  </main>

  <footer class="mt-auto py-3 text-center">

  <small class="text-muted mb-2">
    <i class="fas fa-code"></i> with <i class="fas fa-heart"></i>
    by <strong>Waleed Khamies</strong>
  </small>

  <div class="container-fluid justify-content-center">
<a class="social mx-1" href="mailto:khamiesw@outlook.com" style="color: #6c757d" onmouseover="this.style.color='#db4437'" onmouseout="this.style.color='#6c757d'">
      <i class="fas fa-envelope fa-1x"></i>
    </a><a class="social mx-1" href="https://www.github.com/khamies" style="color: #6c757d" onmouseover="this.style.color='#333333'" onmouseout="this.style.color='#6c757d'">
      <i class="fab fa-github fa-1x"></i>
    </a><a class="social mx-1" href="https://www.linkedin.com/in/khamiesw" style="color: #6c757d" onmouseover="this.style.color='#007bb5'" onmouseout="this.style.color='#6c757d'">
      <i class="fab fa-linkedin-in fa-1x"></i>
    </a>

</div>
<small class="text-muted mb-2">
    Original theme by <a href="https://github.com/YoussefRaafatNasry/portfolYOU">portfolYOU</a>
  </small>
	<br>
  
  <small class="text-muted mb-2">Â© Copyright 2023, The unspoken ML, All Rights Reserved.</small> 
  
</footer>


  
  <!-- GitHub Buttons -->
<script async defer src="https://buttons.github.io/buttons.js"></script>

<!-- jQuery CDN -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<!-- Popper.js CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"></script>

<!-- Bootstrap JS CDN -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

<!-- wow.js CDN & Activation -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/wow/1.1.2/wow.js"></script>
<script> new WOW().init(); </script>

<!-- Initialize all tooltips -->
<script>
$(function () {
    $('[data-toggle="tooltip"]').tooltip()
})
</script>


</body>

</html>